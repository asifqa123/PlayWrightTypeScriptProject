# Test info

- Name: Test Case 16: Place Order: Login before Checkout >> should login with existing user, add product, and complete order
- Location: /app/tests/placeOrderLoginBeforeCheckout.spec.js:88:5

# Error details

```
Error: browserType.launch: Executable doesn't exist at /home/swebot/.cache/ms-playwright/chromium_headless_shell-1169/chrome-linux/headless_shell
╔═════════════════════════════════════════════════════════════════════════╗
║ Looks like Playwright Test or Playwright was just installed or updated. ║
║ Please run the following command to download new browsers:              ║
║                                                                         ║
║     npx playwright install                                              ║
║                                                                         ║
║ <3 Playwright Team                                                      ║
╚═════════════════════════════════════════════════════════════════════════╝
```

# Test source

```ts
   1 | // tests/placeOrderLoginBeforeCheckout.spec.js
   2 | const { test, expect } = require('@playwright/test');
   3 | const { HomePage } = require('../pages/HomePage');
   4 | const { LoginPage } = require('../pages/LoginPage');
   5 | const { SignupPage } = require('../pages/SignupPage'); // For user registration in beforeAll
   6 | const { ProductsPage } = require('../pages/ProductsPage');
   7 | const { CartPage } = require('../pages/CartPage');
   8 | const { CheckoutPage } = require('../pages/CheckoutPage');
   9 | const { PaymentPage } = require('../pages/PaymentPage');
   10 | const { Utils } = require('../utils/utils');
   11 |
   12 | // Load Test Data
   13 | const users = Utils.loadTestData('users.json');
   14 | const productsData = Utils.loadTestData('products.json');
   15 | const paymentData = Utils.loadTestData('formData.json').paymentDetails;
   16 |
   17 | const existingUserData = users.loginBeforeCheckoutUser;
   18 | const productToOrder = productsData.addProductsToCart.products[0]; // Using the first product
   19 |
   20 | // Variables for the user to be created in beforeAll
   21 | let userEmail; // To be set in beforeAll
   22 | let userName;  // To be set in beforeAll
   23 | const userPassword = existingUserData.password;
   24 |
   25 | test.describe('Test Case 16: Place Order: Login before Checkout', () => {
   26 |     let homePage, loginPage, productsPage, cartPage, checkoutPage, paymentPage; // signupPage not needed in test.beforeEach
   27 |
   28 |     test.beforeAll(async ({ browser }) => {
   29 |         // Register the user that will "exist" for this test
   30 |         userEmail = Utils.generateRandomEmail(existingUserData.emailPrefix);
   31 |         userName = Utils.generateRandomName(existingUserData.namePrefix);
   32 |
   33 |         const page = await browser.newPage();
   34 |         const tempHomePage = new HomePage(page);
   35 |         const tempLoginPage = new LoginPage(page);
   36 |         const tempSignupPage = new SignupPage(page);
   37 |
   38 |         await tempHomePage.goto();
   39 |         await tempHomePage.clickSignupLoginLink();
   40 |         await tempLoginPage.signup(userName, userEmail);
   41 |
   42 |         await tempSignupPage.fillAccountInformation(
   43 |             existingUserData.title, userPassword, existingUserData.dobDay, existingUserData.dobMonth, existingUserData.dobYear,
   44 |             false, false // Assuming no newsletter/optin for simplicity here
   45 |         );
   46 |         await tempSignupPage.fillAddressInformation(
   47 |             userName, existingUserData.lastName, existingUserData.company, existingUserData.address1, existingUserData.address2,
   48 |             existingUserData.country, existingUserData.state, existingUserData.city, existingUserData.zipcode, existingUserData.mobileNumber
   49 |         );
   50 |         await tempSignupPage.clickCreateAccountButton();
   51 |         await expect(tempSignupPage.accountCreatedText).toBeVisible();
   52 |         await tempSignupPage.clickContinueButton();
   53 |
   54 |         // Logout this user so they can be logged in by the test
   55 |         if (await page.locator('#ad_position_box').isVisible({ timeout: 5000 })) {
   56 |             await page.evaluate(() => {
   57 |                 const ad = document.getElementById('ad_position_box');
   58 |                 if (ad) ad.remove();
   59 |             });
   60 |         }
   61 |         try {
   62 |             await page.waitForSelector('a[href="/logout"]', { timeout: 10000 });
   63 |             await page.locator('a[href="/logout"]').click();
   64 |         } catch (e) {
   65 |             await page.reload({ waitUntil: 'networkidle' });
   66 |              if (await page.locator('#ad_position_box').isVisible({ timeout: 5000 })) {
   67 |                 await page.evaluate(() => {
   68 |                     const ad = document.getElementById('ad_position_box');
   69 |                     if (ad) ad.remove();
   70 |                 });
   71 |             }
   72 |             await page.waitForSelector('a[href="/logout"]', { timeout: 15000 });
   73 |             await page.locator('a[href="/logout"]').click();
   74 |         }
   75 |         await expect(page).toHaveURL(/.*login/); // Should be on login page after logout
   76 |         await page.close();
   77 |     });
   78 |
   79 |     test.beforeEach(async ({ page }) => {
   80 |         homePage = new HomePage(page);
   81 |         loginPage = new LoginPage(page);
   82 |         productsPage = new ProductsPage(page);
   83 |         cartPage = new CartPage(page);
   84 |         checkoutPage = new CheckoutPage(page);
   85 |         paymentPage = new PaymentPage(page);
   86 |     });
   87 |
>  88 |     test('should login with existing user, add product, and complete order', async ({ page }) => {
      |     ^ Error: browserType.launch: Executable doesn't exist at /home/swebot/.cache/ms-playwright/chromium_headless_shell-1169/chrome-linux/headless_shell
   89 |         // 1. Launch browser and navigate to URL
   90 |         await homePage.goto();
   91 |         await expect(page).toHaveURL('https://automationexercise.com/');
   92 |
   93 |         // 2. Click on 'Signup / Login' button
   94 |         await homePage.clickSignupLoginLink();
   95 |
   96 |         // 3. Fill email, password and click 'Login' button
   97 |         expect(await loginPage.isLoginFormVisible()).toBe(true);
   98 |         await loginPage.login(userEmail, userPassword); // Login with the user created in beforeAll
   99 |
  100 |         // 4. Verify 'Logged in as username' at top
  101 |         if (await page.locator('#ad_position_box').isVisible({ timeout: 5000 })) {
  102 |             await page.evaluate(() => {
  103 |                 const ad = document.getElementById('ad_position_box');
  104 |                 if (ad) ad.remove();
  105 |             });
  106 |         }
  107 |         try {
  108 |             await page.waitForSelector(`li a:has-text("Logged in as ${userName}")`, { timeout: 10000 });
  109 |         } catch (e) {
  110 |             await page.reload({ waitUntil: 'networkidle' });
  111 |             if (await page.locator('#ad_position_box').isVisible({ timeout: 5000 })) {
  112 |                 await page.evaluate(() => {
  113 |                     const ad = document.getElementById('ad_position_box');
  114 |                     if (ad) ad.remove();
  115 |                 });
  116 |             }
  117 |             await page.waitForSelector(`li a:has-text("Logged in as ${userName}")`, { timeout: 15000 });
  118 |         }
  119 |         await expect(page.locator(`li a:has-text("Logged in as ${userName}")`)).toBeVisible();
  120 |
  121 |         // 5. Add products to cart
  122 |         await homePage.clickProductsLink();
  123 |         await productsPage.addProductToCartByName(productToOrder.name);
  124 |         await productsPage.clickContinueShopping();
  125 |
  126 |         // 6. Click 'Cart' button and verify page
  127 |         await homePage.clickCartLink();
  128 |         await expect(page).toHaveURL(/.*view_cart/);
  129 |         expect(await cartPage.isShoppingCartVisible()).toBe(true);
  130 |
  131 |         // 7. Click Proceed To Checkout
  132 |         await cartPage.clickProceedToCheckout();
  133 |
  134 |         // 8. Verify Address Details and Review Your Order
  135 |         await expect(checkoutPage.addressDetailsText).toBeVisible();
  136 |         await expect(checkoutPage.reviewYourOrderText).toBeVisible();
  137 |         const deliveryFirstName = await checkoutPage.getDeliveryAddressFirstName();
  138 |         expect(deliveryFirstName).toContain(userName.replace(existingUserData.namePrefix, existingUserData.firstName));
  139 |
  140 |
  141 |         // 9. Enter description and click 'Place Order'
  142 |         await checkoutPage.enterComment("Order placed by existing user - Login before checkout.");
  143 |         await checkoutPage.clickPlaceOrder();
  144 |
  145 |         // 10. Enter payment details
  146 |         await paymentPage.fillPaymentDetails(
  147 |             paymentData.nameOnCard,
  148 |             paymentData.cardNumber,
  149 |             paymentData.cvc,
  150 |             paymentData.expiryMonth,
  151 |             paymentData.expiryYear
  152 |         );
  153 |
  154 |         // 11. Click 'Pay and Confirm Order'
  155 |         await paymentPage.clickPayAndConfirmOrder();
  156 |
  157 |         // 12. Verify success message
  158 |         await expect(paymentPage.orderPlacedText).toBeVisible({ timeout: 15000 });
  159 |
  160 |         // 13. Click 'Delete Account' button (Optional, for cleanup)
  161 |         await homePage.goto();
  162 |         if (await page.locator('#ad_position_box').isVisible({ timeout: 5000 })) {
  163 |             await page.evaluate(() => {
  164 |                 const ad = document.getElementById('ad_position_box');
  165 |                 if (ad) ad.remove();
  166 |             });
  167 |         }
  168 |         await page.locator('a[href="/delete_account"]').click();
  169 |         await expect(page.locator('h2[data-qa="account-deleted"]')).toBeVisible({ timeout: 10000 });
  170 |         await page.locator('a[data-qa="continue-button"]').click();
  171 |         await expect(page).toHaveURL('https://automationexercise.com/');
  172 |     });
  173 | });
  174 |
```